<!-- CDNでFirebaseを読み込み -->
<script type="module">
  // モジュールを使ったインポート（v9以降の書き方）
  import { initializeApp } from "https://www.gstatic.com/firebasejs/9.6.1/firebase-app.js";
  import { getDatabase, ref, get, child } from "https://www.gstatic.com/firebasejs/9.6.1/firebase-database.js";

  const firebaseConfig = {
    apiKey: "AIzaSyBXOBFzV7Kk0zjXnrWtrPEb101R3Xmew_c",
    authDomain: "netzero1-fc5e6.firebaseapp.com",
    databaseURL: "https://netzero1-fc5e6-default-rtdb.firebaseio.com",
    projectId: "netzero1-fc5e6",
    storageBucket: "netzero1-fc5e6.firebasestorage.app",
    messagingSenderId: "1089803832530",
    appId: "1:1089803832530:web:9216e96f2df305b2b7f10b",
    measurementId: "G-1FN7CQEHK3"
  };

  const app = initializeApp(firebaseConfig);
  const db = getDatabase(app);

  document.addEventListener("DOMContentLoaded", async () => {
    const goodList = document.getElementById("good-list");
    const messageList = document.getElementById("message-list");

    try {
      const snapshot = await get(child(ref(db), "goodCounts"));
      const data = snapshot.val() || {};

      Object.entries(data).forEach(([key, count]) => {
        const li = document.createElement("li");
        li.textContent = `作品${key} のグッド数: ${count}`;
        goodList.appendChild(li);
      });
    } catch (err) {
      console.error("グッド取得失敗:", err);
    }

    try {
      const snapshot = await get(child(ref(db), "messages"));
      const data = snapshot.val() || {};

      Object.entries(data).forEach(([key, messages]) => {
        if (Array.isArray(messages) && messages.length > 0) {
          const li = document.createElement("li");
          li.textContent = `作品${key} のメッセージ: ${messages.join(", ")}`;
          messageList.appendChild(li);
        }
      });
    } catch (err) {
      console.error("メッセージ取得失敗:", err);
    }
  });
</script>
